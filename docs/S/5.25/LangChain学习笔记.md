# LangChainå¿«é€Ÿå…¥é—¨

## LangChainçš„å®šä¹‰

LangChain æ˜¯ä¸€ä¸ªå¼€æºçš„å¼€å‘æ¡†æ¶,ï¼Œçš†åœ¨å¸®åŠ©å¼€å‘è€…å¿«é€Ÿæ„å»ºåŸºå‹å¤§æ¨¡å‹(LLM)çš„åº”ç”¨ç¨‹åºï¼Œå®ƒé€šè¿‡æ¨¡å—åŒ–è®¾è®¡ç®€åŒ–äº†ä¸å¤§æ¨¡å‹äº¤äº’çš„å¤æ‚æ€§,æ”¯æŒçµæ´»é›†æˆå¤–éƒ¨å·¥å…·å’Œæ•°æ®æºï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿé«˜æ•ˆå®ç°å¤æ‚çš„AIåº”ç”¨é€»è¾‘ã€‚

![image-20250525182647438](/Users/xt03337/Documents/çŸ¥è¯†åº“/Learning-Alliance/docs/S/å›¾ç‰‡/image-20250525182647438.png)

LangChainæ¡†æ¶ç”±å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼ŒåŒ…æ‹¬ï¼š

- LangChainåº“ï¼šPythonå’ŒJavaScriptåº“ã€‚åŒ…æ‹¬æ¥å£å’Œé›†æˆå¤šç§ç»„ä»¶çš„è¿è¡ŒåŸºç¡€ï¼Œä»¥åŠç°æˆçš„é“¾å’Œä»£ç†çš„å®ç°ã€‚
- LangChainæ¨¡ç‰ˆï¼šLangChainå®˜æ–¹æä¾›ä¸€äº›AIä»»åŠ¡æ¨¡ç‰ˆã€‚
- LangServeï¼šåŸºäºFastApiå¯ä»¥å°†LangChainå®šä¹‰é“¾ï¼Œå‘å¸ƒç§°ä¸ºREST APIã€‚
- LangSmithï¼šå¼€å‘å¹³å°ï¼Œæ˜¯ä¸ªäº‘æœåŠ¡ï¼Œæ”¯æŒLangChain Debugã€ä»»åŠ¡ç›‘æ§ã€‚

LangChainåº“ï¼ˆLibrariesï¼‰ï¼š

LangChainåº“æœ¬èº«ç”±å‡ ä¸ªä¸åŒçš„åŒ…ç»„æˆï¼š

- Langchain-coreï¼šåŸºç¡€æŠ½è±¡çš„LangChainè¡¨è¾¾è¯­è¨€ã€‚
- langchain-communityï¼šç¬¬ä¸‰æ–¹ç»§æ‰¿ã€‚
  - åˆä½œä¼™ä¼´åŒ…ï¼ˆä¾‹å¦‚langchain-openaiï¼Œlangchain-anthropicç­‰ï¼‰ï¼šä¸€äº›é›†æˆå·²è¿›ä¸€æ­¥æ‹†åˆ†ä¸ºä»…ä¾èµ–äºlangchain-coreçš„è½»é‡çº§åŒ…ã€‚
- langchainï¼šæ„å»ºåº”ç”¨ç¨‹åºè®¤çŸ¥æ¶æ„çš„é“¾ã€ä»£ç†å’Œæ£€ç´¢ç­–ç•¥ã€‚

LangChainä»»åŠ¡å¤„ç†æµç¨‹

![image-20250525190108913](/Users/xt03337/Documents/çŸ¥è¯†åº“/Learning-Alliance/docs/S/å›¾ç‰‡/image-20250525190108913.png)

å¦‚ä¸Šå›¾ï¼ŒLangChainæä¾›ä¸€å¥—æç¤ºè¯æ¨¡ç‰ˆç®¡ç†å·¥å…·ï¼Œè´Ÿè´£å¤„ç†æç¤ºè¯ï¼Œç„¶åä¼ é€’ç»™å¤§æ¨¡å‹å¤„ç†ï¼Œæœ€åå¤„ç†å¤§æ¨¡å‹è¿”å›çš„ç»“æœã€‚

LangChainå¯¹å¤§æ¨¡å‹çš„å°è£…ä¸»è¦åŒ…æ‹¬LLMå’ŒChat Modelä¸¤ç§ç±»å‹ï¼š

- LLM-é—®ç­”æ¨¡å‹ï¼Œæ¨¡å‹æ¥æ”¶ä¸€ä¸ªæ–‡æœ¬è¾“å…¥ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–‡æœ¬ç»“æœã€‚
- Chat Model-å¯¹è¯æ¨¡å‹ï¼Œæ¥æ”¶ä¸€ç»„å¯¹è¯æ¶ˆæ¯ï¼Œç„¶åè¿”æ²ªå¯¹è¯æ¶ˆæ¯ï¼Œç±»ä¼¼èŠå¤©ä¿¡æ¯ä¸€æ ·ã€‚

## æ ¸å¿ƒæ¦‚å¿µ

1. LLMs

   LangChainå°è£…çš„åŸºç¡€æ¨¡å‹ï¼Œæ¨¡å‹æ¥æ”¶ä¸€ä¸ªæ–‡æœ¬è¾“å…¥ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–‡æœ¬ç»“æœã€‚

2. Chat Modelsï¼ˆèŠå¤©æ¨¡å‹ï¼‰

   èŠå¤©ç±»å‹ï¼Œä¸LLMsä¸åŒï¼Œè¿™äº›æ¨¡å‹è½¬ä¸ºå¯¹è¯åœºæ™¯è€Œè®¾è®¡ï¼Œæ¨¡å‹å¯ä»¥æ¥æ”¶ä¸€ç»„å¯¹è¯æ¶ˆæ¯ï¼Œç„¶åæŸ“ç°å¯¹è¯æ¶ˆæ¯ï¼Œç±»ä¼¼èŠå¤©æ¶ˆæ¯ä¸€æ ·ã€‚

3. æ¶ˆæ¯ï¼ˆMessageï¼‰

   æŒ‡çš„æ˜¯èŠå¤©æ¨¡å‹çš„æ¶ˆæ¯å†…å®¹ï¼Œæ¶ˆæ¯ç±»å‹åŒ…æ‹¬HumanMessageã€ALMessgaeã€SystemMessageã€FunctionMessageå’ŒToolMessageç­‰å¤šç§ç±»å‹çš„æ¶ˆæ¯ã€‚

4. æç¤ºï¼ˆpromptsï¼‰

   LangChainå°è£…äº†ä¸€ç»„ä¸“é—¨ç”¨äºæç¤ºè¯ï¼ˆpromptsï¼‰ç®¡ç†çš„å·¥å…·ç±»ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ ¼å¼åŒ–æç¤ºè¯å†…å®¹ã€‚

5. è¾“å‡ºè§£æå™¨ï¼ˆOutput Parersï¼‰

   å¦‚ä¸Šå›¾ä»‹ç»ï¼ŒLangChainæ¥æ”¶å¤§æ¨¡å‹è¿”å›çš„æ–‡æœ¬å†…å®¹ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ä¸“é—¨çš„è¾“å‡ºè§£æå™¨å¯¹æ–‡æœ¬å†…å®¹è¿›è¡Œæ ¼å¼åŒ–ï¼Œä¾‹å¦‚è§£æJsonã€pythonå¯¹è±¡ã€‚

6. Retrievers

   ä¸ºæ–¹ä¾¿æˆ‘ä»¬å°†ç§æœ‰æ•°æ®å¯¼å…¥åˆ°å¤§æ¨¡å‹ï¼Œæé«˜æ¨¡å‹å›ç­”é—®é¢˜çš„è´¨é‡ï¼ŒLangChainå°è£…äº†æ£€ç´¢æ¡†æ¶ï¼Œæ–¹ä¾¿æˆ‘ä»¬åŠ è½½æ–‡æ¡£ã€åˆ‡å‰²ã€å­˜å‚¨å’Œæ£€ç´¢æ–‡æ¡£æ•°æ®ã€‚

7. å‘é‡å­˜å‚¨ï¼ˆVector storesï¼‰

   ä¸ºæ”¯æŒç§æœ‰æ•°æ®çš„è¯­ä¹‰ç›¸ä¼¼æœç´¢ï¼Œlangchainæ”¯æŒå¤šç§å‘é‡æ•°æ®åº“ã€‚

8. Agents

   æ™ºèƒ½ä½“ï¼Œé€šå¸¸æŒ‡ä»¥å¤§æ¨¡å‹ä¸ºå†³ç­–å¼•æ“ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„ä»»åŠ¡ï¼Œè‡ªåŠ¨è°ƒç”¨å¤–éƒ¨ç³»ç»Ÿã€ç¡¬ä»¶è®¾å¤‡å…±åŒå®Œæˆç”¨æˆ·ä»»åŠ¡ï¼Œæ˜¯ä¸€ç§ä»¥å¤§æ¨¡å‹ä¸ºæ ¸å¿ƒçš„åº”ç”¨è®¾è®¡æ¨¡å¼ã€‚

## æ ¸å¿ƒåŠŸèƒ½

ï¼ˆ1ï¼‰æ¨¡å—é›†æˆï¼ˆModelsï¼‰

- ä½œç”¨ï¼šç»Ÿä¸€å‡ å£å¯¹æ¥å¤šç§å¤§æ¨¡å‹ï¼ˆå¦‚OpenAI GPTã€Anthropicã€Hugging Faceç­‰ï¼‰ï¼Œé¿å…å‚å•†é”å®šã€‚
- ç¤ºä¾‹ï¼šé€šè¿‡ChatOpenAIæˆ–CharAnthropicç±»å¿«é€Ÿåˆ‡æ¢ä¸åŒæ¨¡å‹ï¼Œå®ç°å¯¹è¯ã€æ–‡æœ¬ç”Ÿæˆç­‰ä»»åŠ¡ã€‚

ï¼ˆ2ï¼‰æ¨¡å—åŒ–ç»„ä»¶ï¼ˆComponentsï¼‰

- æç¤ºæ¨¡å—ï¼ˆPromptsï¼‰ï¼šæ ‡å‡†åŒ–æç¤ºè¯ç®¡ç†ï¼Œæ”¯æŒå˜é‡æ³¨å…¥å’ŒåŠ¨æ€ç”Ÿæˆï¼ˆå¦‚Few-shot Learningï¼‰
- æ–‡æ¡£åŠ è½½å™¨ï¼ˆDocument Loadersï¼‰ï¼šæ”¯æŒPDFã€ç½‘é¡µã€æ•°æ®åº“ç­‰æ•°æ®æºçš„åŠ è½½ä¸é¢„å¤„ç†ã€‚
- æ–‡æ¡£åˆ†å‰²å™¨ï¼ˆText Splittersï¼‰ï¼šå°†é•¿æ–‡æœ¬åˆ‡åˆ†ä»¥é€‚åº”æ¨¡å‹è¾“å…¥é™åˆ¶ã€‚
- å‘é‡å­˜å‚¨ï¼ˆVector Storesï¼‰ï¼šé›†æˆFAISSã€Chromaç­‰å·¥å…·ï¼Œå®ç°æ–‡æœ¬å‘é‡åŒ–ä¸ç›¸ä¼¼æ€§æ£€ç´¢ã€‚

ï¼ˆ3ï¼‰é“¾å¼è°ƒç”¨ï¼ˆChainsï¼‰

- ä½œç”¨ï¼šå°†å¤šä¸ªæ­¥éª¤ç»„åˆæˆå¯é‡å¤çš„æµç¨‹ï¼Œå¤„ç†å¤æ‚ä»»åŠ¡ã€‚
- å…¸å‹é“¾ï¼šRetrievalQAï¼ˆæ£€ç´¢+ç”Ÿæˆï¼‰ã€SequentialChainï¼ˆé¡ºåºæ‰§è¡Œå¤šä¸ªæ¨¡å‹è°ƒç”¨ï¼‰ã€‚
- åœºæ™¯ï¼šæ„å»ºé—®ç­”ç³»ç»Ÿæ—¶ï¼Œå…ˆæ£€ç´¢çŸ¥è¯†åº“ï¼Œåœ¨ç”Ÿæˆå›ç­”ã€‚

ï¼ˆ4ï¼‰è®°å¿†æœºåˆ¶ï¼ˆMemoryï¼‰

- ä½œç”¨ï¼šç»´æŠ¤å¯¹è¯å†å²æˆ–ä¸Šä¸‹æ–‡çŠ¶æ€ï¼Œæ”¯æŒå¤šè½®äº¤äº’ã€‚
- å®ç°æ–¹å¼ï¼šé€šè¿‡ConversationBufferMemoryæˆ–ConversationSummaryMemoryå­˜å‚¨å’Œç®¡ç†å†å²ä¿¡æ¯ã€‚

ï¼ˆ5ï¼‰ä»£ç†ä¸å·¥å…·ï¼ˆAgents & Toolsï¼‰

- ä»£ç†ï¼ˆAgentsï¼‰ï¼šè®©LLMåŠ¨æ€é€‰æ‹©è°ƒç”¨å·¥å…·ï¼Œå®ç°æ™ºèƒ½å†³ç­–ï¼ˆå¦‚â€œä½¿ç”¨æœç´¢APIæŸ¥è¯¢å¤©æ°”ï¼Œå†ç”¨è®¡ç®—å™¨è½¬åŒ–å•ä½â€ï¼‰ã€‚
- å·¥å…·ï¼ˆToolsï¼‰ï¼šé¢„ç½®æœç´¢å¼•æ“ã€Python REPLã€APIè°ƒç”¨ç­‰å·¥å…·ï¼Œæ”¯æŒè‡ªå®šä¹‰æ‰©å±•ã€‚

ï¼ˆ6ï¼‰æ•°æ®å¢å¼ºï¼ˆRAGï¼‰

- ä½œç”¨ï¼šå°†å¤–éƒ¨æ•°æ®ï¼ˆå¦‚æ–‡æ¡£ã€æ•°æ®åº“ï¼‰ä¸LLMç»“åˆæå‡ç”Ÿæˆå†…å®¹çš„å‡†ç¡®æ€§å’Œç›¸å…³æ€§ã€‚
- æµç¨‹ï¼šåŠ è½½æ•°æ®->å‘é‡åŒ–->æ£€ç´¢ç›¸å…³ç‰‡æ®µ->æ³¨å…¥æç¤ºè¯->ç”Ÿæˆæœ€ç»ˆå›ç­”ã€‚

## å…¸å‹åº”ç”¨åœºæ™¯

- æ™ºèƒ½é—®ç­”ç³»ç»Ÿï¼šç»“åˆRAGå¤„ç†é¢†åŸŸçŸ¥è¯†åº“ã€‚
- å¯¹è¯æœºå™¨äººï¼šæ”¯æŒå¤šè½®ä¼šè¯ã€ä¸ªæ€§åŒ–è®°å¿†ã€‚
- æ–‡æ¡£åˆ†æï¼šè‡ªåŠ¨æ€»ç»“é•¿æ–‡æœ¬ï¼Œæå–å…³é”®ä¿¡æ¯ã€‚
- è‡ªåŠ¨åŒ–æµç¨‹ï¼šé€šè¿‡ä»£ç†è°ƒç”¨å·¥å…·æ‰§è¡Œä»£ç ã€å‘é€é‚®ä»¶ç­‰æ“ä½œã€‚
- ä»£ç ç”Ÿæˆï¼šæ ¹æ®éœ€è¦æè¿°ç”Ÿæˆå¹¶éªŒè¯ä»£ç ç‰‡æ®µã€‚

## å¿«é€Ÿå…¥é—¨

### å®‰è£…LangChain

```python
pip install langchain
```

### åˆå§‹åŒ–æ¨¡å‹

åœ¨ä½¿ç”¨langchainä¹‹å‰ï¼Œéœ€è¦å¯¼å…¥LangChain X OpenAIé›†æˆåŒ…ï¼Œå¹¶è®¾ç½®APIå¯†é’¥ä½œä¸ºç¯å¢ƒå˜é‡æˆ–ç›´æ¥ä¼ é€’ç»™OpenAI LLMç±»ã€‚

é¦–å…ˆï¼Œè·å–OpenAIçš„apiå¯†é’¥ï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºè´¦æˆ·å¹¶è®¿é—®é“¾æ¥è·å–ï¼Œç„¶åå°†APIå¯†é’¥è®¾ç½®ä¸ºç¯å¢ƒå˜é‡ï¼š

```
export OPENAI_API_KEY = ""
from langchain_openai import ChatOpenAI
llm = ChatOpenAI()
```

### è¾“å‡ºè½¬åŒ–

LLMçš„è¾“å‡ºé€šå¸¸æ˜¯ä¸€æ¡æ¶ˆæ¯ï¼Œä¸ºäº†æ›´æ–¹ä¾¿å¤„ç†ç»“æœï¼Œå¯ä»¥å°†æ¶ˆæ¯è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚

```python
from langchain_core.output_parsers import StrOutputParser
output_parser = StrOutputParser()
```

### ç›¸å…³ä»£ç 

```python
from langchain_core.prompts import ChatPromptTemplate
from langchain_openai import ChatOpenAI
from langchain_core.output_parsers import StrOutputParser

llm = ChatOpenAI(
    temperature=0,
    model="gpt-3.5-turbo"
)

# å®šä¹‰ä¸€ä¸ªè¾“å‡ºè§£æå™¨
output_parser = StrOutputParser()

prompt = ChatPromptTemplate.from_messages(
    ("system", "ä½ æ˜¯ä¸€åæ•°æ®åº“ä¸“å®¶")
    ("user", "{input}")
)

chain = prompt | llm | output_parser

result = chain.invoke({"input": "å¸®æˆ‘å†™ä¸€ç¯‡æŠ€æœ¯æ–‡æ¡£ï¼Œ100å­—å·¦å³"})

print(result)
```

# LangChainæç¤ºè¯å·¥ç¨‹åº”ç”¨å®è·µ

## Prompt templatesï¼ˆæç¤ºè¯æ¨¡ç‰ˆï¼‰

è¯­è¨€æ¨¡å‹ä»¥æ–‡æœ¬ä½œä¸ºè¾“å…¥ - è¿™ä¸ªæ–‡æœ¬é€šå¸¸è¢«ç§°ä¸ºæç¤ºè¯ï¼ˆpromptï¼‰ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯¹äºæç¤ºè¯é€šå¸¸ä¸èƒ½ç›´æ¥ç¡¬ç¼–ç ï¼Œä¸åˆ©äºæç¤ºè¯ç®¡ç†ï¼Œè€Œæ˜¯é€šè¿‡æç¤ºè¯æ¨¡ç‰ˆè¿›è¡Œç»´æŠ¤ï¼Œç±»ä¼¼å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„çŸ­ä¿¡æ¨¡ç‰ˆã€é‚®ä»¶æ¨¡ç‰ˆç­‰ç­‰ã€‚

![image-20250525190108913](/Users/xt03337/Documents/çŸ¥è¯†åº“/Learning-Alliance/docs/S/å›¾ç‰‡/image-20250525190108913.png)

## ä»€ä¹ˆæ˜¯æç¤ºè¯æ¨¡ç‰ˆï¼Ÿ

æç¤ºè¯æ¨¡ç‰ˆæœ¬è´¨ä¸Šè·Ÿå¹³æ—¶å¤§å®¶ä½¿ç”¨çš„é‚®ä»¶ã€çŸ­ä¿¡æ¨¡ç‰ˆæŸæ¸¸ä»€ä¹ˆåŒºåˆ«ï¼Œå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ¨¡ç‰ˆï¼Œæ¨¡ç‰ˆå¯ä»¥åŒ…å«ä¸€ç»„æ¨¡ç‰ˆå‚æ•°ï¼Œé€šè¿‡æ¨¡ç‰ˆå‚æ•°å¯ä»¥æ›¿æ¢æ¨¡ç‰ˆå¯¹åº”çš„å‚æ•°ã€‚

ä¸€ä¸ªæç¤ºè¯æ¨¡ç‰ˆå¯ä»¥åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

- å‘ç»™å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„æŒ‡ä»¤ã€‚
- ä¸€ç»„é—®ç­”ç¤ºä¾‹ï¼Œä»¥æé†’AIä»¥ä»€ä¹ˆæ ¼å¼è¿”å›è¯·æ±‚ã€‚
- å‘ç»™è¯­è¨€æ¨¡å‹çš„é—®é¢˜ã€‚

## åˆ›å»ºä¸€ä¸ªæç¤ºè¯æ¨¡ç‰ˆï¼ˆprompt templateï¼‰

å¯ä»¥ä½¿ç”¨PromptTemplateç±»åˆ›å»ºç®€å•çš„æç¤ºè¯ã€‚æç¤ºè¯æ¨¡ç‰ˆå¯ä»¥å†…åµŒä»»æ„æ•°é‡çš„æ¨¡ç‰ˆå‚æ•°ï¼Œç„¶åé€šè¿‡å‚æ•°å€¼æ ¼å¼åŒ–æ¨¡ç‰ˆå†…å®¹ã€‚

```python
from langchain_core.prompts import PromptTemplate

prompt_template = PromptTemplate.from_template(
    "ç»™æˆ‘è®²ä¸€ä¸ªå…³äº{content}çš„{adjective}ç¬‘è¯"
)
result = prompt_template.format(adjective="å†·", content="ç‹—")
print(result)
```

## èŠå¤©æ¶ˆæ¯æç¤ºè¯æ¨¡ç‰ˆ(chat prompt template)

èŠå¤©æ¨¡å‹ï¼ˆChat Modelï¼‰ä»¥èŠå¤©æ¶ˆæ¯åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œè¿™ä¸ªèŠå¤©æ¶ˆæ¯åˆ—è¡¨çš„æ¶ˆæ¯å†…å®¹ä¹Ÿå¯ä»¥é€šè¿‡æç¤ºè¯æ¨¡ç‰ˆè¿›è¡Œç®¡ç†ã€‚è¿™äº›èŠå¤©æ¶ˆæ¯ä¸åŸå§‹å­—ç¬¦ä¸²ä¸åŒï¼Œå› ä¸ºæ¯ä¸ªæ¶ˆæ¯éƒ½ä¸â€œè§’è‰²â€ç›¸å…³è”ã€‚

ä¾‹å¦‚ï¼Œåœ¨OpenAIçš„Chat Completion APIä¸­ï¼ŒOpenAiçš„èŠå¤©æ¨¡å‹ï¼Œç»™ä¸åŒçš„èŠå¤©æ¶ˆæ¯å®šä¹‰äº†ä¸‰ç§è§’è‰²ç±»å‹åˆ†åˆ«æ˜¯åŠ©æ‰‹(assistant)ã€äººç±» (human)ã€ç³»ç»Ÿ (system)è§’è‰²ï¼š

- åŠ©æ‰‹(assistant)æ¶ˆæ¯æŒ‡çš„æ˜¯å½“å‰æ¶ˆæ¯æ˜¯AIå›ç­”çš„å†…å®¹ã€‚
- äººç±» (human)æ¶ˆæ¯æŒ‡çš„æ˜¯ä½ å‘ç»™AIçš„å†…å®¹ã€‚
- ç³»ç»Ÿ (system)æ¶ˆæ¯é€šå¸¸æ˜¯ç”¨æ¥ç»™AIèº«ä»½è¿›è¡Œæè¿°ã€‚

```python
import os
from langchain_core.prompts import ChatPromptTemplate

chat_prompt = ChatPromptTemplate.from_messages(
    [
        ("system", "ä½ æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œä½ çš„åå­—æ˜¯{name}ã€‚"),
        ("human", "ä½ å¥½"),
        ("ai", "æˆ‘å¾ˆå¥½ï¼Œè°¢è°¢ï¼"),
        ("human", "{user_input}"),
    ]
)

messages = chat_prompt.format_messages(name="Bob", user_input="ä½ çš„åå­—å«ä»€ä¹ˆ?")
print(messages)
```

å¦ä¸€ç§æ¶ˆæ¯æ ¼å¼ä¾‹å­ï¼š 

```python
from langchain_core.messages import SystemMessage
from langchain_core.prompts import ChatPromptTemplate
from langchain.prompts import HumanMessagePromptTemplate

chat_template = ChatPromptTemplate.from_messages(
    [
        SystemMessage(
            content=(
                "ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„åŠ©æ‰‹ï¼Œå¯ä»¥å…¥è‰²å†…å®¹ï¼Œä½¿å…¶çœ‹èµ·æ¥æ›´ç®€å•æ˜“è¯»ã€‚"
            )
        ),
        HumanMessagePromptTemplate.from_template("{text}")
    ]
)

message = chat_template.format_messages(text="æˆ‘æœ€è¿‘ä¸ºäº†å­¦ä¹ å¤´ç–¼")
print(message)
```

é€šå¸¸æˆ‘ä»¬ä¸ä¼šç›´æ¥ä½¿ç”¨format_messageså‡½æ•°æ ¼å¼åŒ–æç¤ºè¯æ¨¡ç‰ˆå†…å®¹ï¼Œè€Œæ˜¯äº¤ç»™LangChainæ¡†æ¶è‡ªåŠ¨å¤„ç†ã€‚

## MessagesPlaceholder

è¿™ä¸ªæç¤ºæ¨¡ç‰ˆè´Ÿè´£åœ¨ç‰¹å®šä½ç½®æ·»åŠ æ¶ˆæ¯åˆ—è¡¨ï¼Œåœ¨ä¸Šé¢ChatPromptTemplateä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•æ ¼å¼åŒ–ä¸¤æ¡æ¶ˆæ¯ï¼Œæ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä½†æ˜¯æˆ‘ä»¬å¸Œæœ›ç”¨æˆ·ä¼ å…¥ä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†å…¶æ’å…¥åˆ°ç‰¹å®šçš„ä½ç½®ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿè¿™å°±æ˜¯ä½¿ç”¨MessagesPlaceholderçš„æ–¹å¼ã€‚

```python
from langchain_core.messages import HumanMessage
from langchain_core.prompts import ChatPromptTemplate, MessagesPlaceholder


prompt_template = ChatPromptTemplate.from_messages([
    ("system", "you are a helpful assistant"),
    MessagesPlaceholder("msgs")
])

prompt_template.invoke({"msgs": [HumanMessage(content="hi!")]})
```

è¿™å°†ç”Ÿæˆä¸¤æ¡æ¶ˆæ¯ï¼Œç¬¬ä¸€æ¡æ˜¯ç³»ç»Ÿæ¶ˆæ¯ï¼Œç¬¬äºŒæ¡æ˜¯æˆ‘ä»¬ä¼ å…¥çš„HumanMessageã€‚å¦‚æœæˆ‘ä»¬ä¼ å…¥äº†5æ¡æ¶ˆæ¯ï¼Œé‚£ä¹ˆæ€»å…±ä¼šç”Ÿæˆ6æ¡æ¶ˆæ¯(ç³»ç»Ÿæ¶ˆæ¯åŠ ä¸Šä¼ å…¥çš„5æ¡æ¶ˆæ¯)ã€‚è¿™å¯¹äºå°†ä¸€ç³»åˆ—æ¶ˆæ¯æ’å…¥åˆ°ç‰¹å®šä½ç½®éå¸¸æœ‰ç”¨ã€‚å¦ä¸€ç§å®ç°ç›¸åŒæ•ˆæœçš„æ›¿ä»£æ–¹å¼æ˜¯ï¼Œä¸ç›´æ¥ä½¿ç”¨MessagesPlaceholderç±»ï¼Œè€Œæ˜¯ï¼š

```python
prompt_template = ChatPromptTemplate.from_messages([
    ("system", "you are a helpful assistant"),
    ("placeholder", "{msgs}")
])

prompt_template.invoke({"msgs": [HumanMessage(content="hi!")]})
```

## æç¤ºè¯è¿½åŠ ç¤ºä¾‹ï¼ˆFew-shot prompt templatesï¼‰

æç¤ºè¯ä¸­åŒ…å«äº¤äº’æ ·æœ¬çš„ä½œç”¨æ˜¯ä¸ºäº†å¸®åŠ©æ¨¡å‹æ›´å¥½çš„ç†è§£ç”¨æˆ·çš„æ„å›¾ï¼Œä»è€Œæ›´å¥½çš„å›ç­”é—®é¢˜æˆ–æ‰§è¡Œä»»åŠ¡ã€‚å°æ ·æœ¬æç¤ºæ¨¡ç‰ˆæ˜¯æŒ‡ä½¿ç”¨ä¸€ç»„å°‘é‡çš„ç¤ºä¾‹æ¥æŒ‡å¯¼æ¨¡å‹å¤„ç†æ–°çš„è¾“å…¥ã€‚è¿™äº›å®ä¾‹å¯ä»¥ç”¨æ¥è®­ç»ƒæ¨¡å‹ï¼Œä»¥ä¾¿æ¨¡å‹å¯ä»¥æ›´å¥½çš„ç†è§£å’Œå›ç­”ç±»ä¼¼çš„é—®é¢˜ã€‚

## ä½¿ç”¨ç¤ºä¾‹é€‰æ‹©å™¨

### å°†ç¤ºä¾‹æä¾›ç»™ExampleSelector

è¿™é‡Œé‡ç”¨å‰ä¸€éƒ¨åˆ†ä¸­çš„ç¤ºä¾‹é›†å’Œæç¤ºè¯æ¨¡ç‰ˆã€‚ä½†æ˜¯ï¼Œä¸ä¼šå°†ç¤ºä¾‹ç›´æ¥æä¾›ç»™æç¤ºè¯è¿½åŠ ç¤ºä¾‹å¯¹è±¡ï¼ŒæŠŠå…¨éƒ¨ç¤ºä¾‹æ’å…¥åˆ°æç¤ºè¯ä¸­ï¼Œè€Œæ˜¯å°†å®ƒä»¬æä¾›ç»™ä¸€ä¸ªExampleSelectorå¯¹è±¡ï¼Œæ’å…¥éƒ¨åˆ†ç¤ºä¾‹ã€‚

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨SemanticSimilarityExampleSelectorç±»ã€‚è¯¥ç±»æ ¹æ®ä¸è¾“å…¥çš„ç›¸ä¼¼æ€§é€‰æ‹©å°æ ·æœ¬ç¤ºä¾‹ã€‚å®ƒä½¿ç”¨åµŒå…¥æ¨¡å‹è®¡ç®—è¾“å…¥å’Œå°æ ·æœ¬ç¤ºä¾‹ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œç„¶åä½¿ç”¨å‘é‡æ•°æ®åº“æ‰§è¡Œç›¸ä¼¼æœç´¢ï¼Œè·å–è·Ÿè¾“å…¥ç›¸ä¼¼çš„ç¤ºä¾‹ã€‚

- æç¤ºï¼šè¿™é‡Œæ¶‰åŠå‘é‡è®¡ç®—ã€å‘é‡æ•°æ®åº“ï¼Œåœ¨AIé¢†åŸŸè¿™ä¸¤ä¸ªä¸»è¦ç”¨äºæ•°æ®ç›¸ä¼¼åº¦æœç´¢ã€‚

# LangChainå·¥ä½œæµç¼–æ’

## LCELä»‹ç»

LCEL(LangChain Expression Language)æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥ä½œæµç¼–æ’å·¥å…·ï¼Œå¯ä»¥ä»åŸºæœ¬ç»„ä»¶æ„å»ºå¤æ‚ä»»åŠ¡é“¾æ¡ï¼ˆchainï¼‰ï¼Œå¹¶æ”¯æŒè¯¸å¦‚æµå¼å¤„ç†ã€å¹¶è¡Œå¤„ç†å’Œæ—¥å¿—è®°å½•ç­‰å¼€ç®±å³ç”¨çš„åŠŸèƒ½ã€‚

LCELä»ç¬¬ä¸€å¤©å°±è¢«è®¾è®¡ä¸ºæ”¯æŒå°†åŸå‹æŠ•å…¥ç”Ÿäº§ï¼Œæ— éœ€æ›´æ”¹ä»£ç ï¼Œä»æœ€ç®€å•çš„â€œæç¤º+LLMâ€é“¾åˆ°æœ€å¤æ‚çš„é“¾ï¼ˆæˆ‘ä»¬å·²ç»çœ‹åˆ°æœ‰äººæˆåŠŸåœ°åœ¨ç”Ÿäº§ä¸­è¿è¡Œäº†åŒ…å«æ•°ç™¾æ­¥çš„LCELé“¾ï¼‰ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨LCELçš„å‡ å¤§äº®ç‚¹ï¼š

- ä¸€æµçš„æµå¼æ”¯æŒï¼šå½“ä½¿ç”¨LCELæ„å»ºé“¾æ˜¯ï¼Œå°†è·å¾—å¯èƒ½çš„æœ€ä½³æ—¶é—´åˆ°ç¬¬ä¸€ä¸ªæ ‡è®°ï¼ˆç›´åˆ°è¾“å‡ºçš„ç¬¬ä¸€å—å†…å®¹å‡ºç°æ‰€ç»è¿‡çš„æ—¶é—´ï¼‰ã€‚å¯¹äºæŸäº›é“¾ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ç›´æ¥ä»LLMæµå¼ä¼ è¾“æ ‡è®°åˆ°æµå¼è¾“å‡ºè§£æå™¨ï¼Œå°†ä»¥ä¸LLMæä¾›ç¨‹åºè¾“å‡ºåŸå§‹æ ‡è®°çš„é€Ÿç‡ç›¸åŒçš„é€Ÿåº¦è·å–è§£æçš„å¢é‡è¾“å‡ºå—ã€‚
- å¼‚æ­¥æ”¯æŒï¼šä½¿ç”¨LCELæ„å»ºçš„ä»»ä½•é“¾éƒ½å¯ä»¥ä½¿ç”¨åŒæ­¥APIä»¥åŠå¼‚æ­¥APIè¿›è¡Œè°ƒç”¨ã€‚è¿™ä½¿å¾—å¯ä»¥åœ¨åŸå‹å’Œç”Ÿäº§ä¸­ä½¿ç”¨ç›¸åŒçš„ä»£ç ï¼Œå…·æœ‰å‡ºè‰²çš„æ€§èƒ½ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨åŒä¸€æœåŠ¡å™¨ä¸­å¤„ç†è®¸å¤šå¹¶å‘è¯·æ±‚ã€‚
- ä¼˜åŒ–çš„å¹¶è¡Œæ‰§è¡Œï¼šæ¯å½“LCELé“¾å…·æœ‰å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„æ­¥éª¤æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œæ— è®ºæ˜¯åœ¨åŒæ­¥æ¥å£è¿˜æ˜¯å¼‚æ­¥æ¥å£ä¸­ï¼Œä»¥è·å–å¯èƒ½çš„æœ€å°å»¶è¿Ÿã€‚
- é‡è¯•å’Œå›é€€ï¼šä¸ºLCELé“¾çš„ä»»ä½•éƒ¨åˆ†é…ç½®é‡è¯•å’Œå›é€€ã€‚è¿™ä½¿é“¾åœ¨è§„æ¨¡ä¸Šæ›´å¯é çš„å¥½åŠæ³•ã€‚ç›®å‰æ­£åœ¨åŠªåŠ›ä¸ºé‡è¯•/å›é€€æ·»åŠ æµå¼æ”¯æŒï¼Œè¿™æ ·å°±å¯ä»¥è·å¾—é¢å¤–çš„å¯é æ€§è€Œæ— éœ€ä»»ä½•å»¶è¿Ÿæˆæœ¬ã€‚
- è®¿é—®ä¸­é—´ç»“æœï¼šå¯¹äºæ›´å¤æ‚çš„é“¾ï¼Œè®¿é—®ä¸­é—´æ­¥éª¤çš„ç»“æœé€šå¸¸éå¸¸æœ‰ç”¨ï¼Œå³ä½¿åœ¨ç”Ÿæˆæœ€ç»ˆè¾“å‡ºä¹‹å‰ã€‚è¿™å¯ä»¥ç”¨äºè®©æœ€ç»ˆç”¨æˆ·çŸ¥é“æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œç”šè‡³åªæ˜¯ç”¨äºè°ƒç”¨é“¾ã€‚å¯ä»¥æµå¼ä¼ è¾“ä¸­é—´ç»“æœï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªLangServeæœåŠ¡å™¨ä¸Šéƒ½å¯ä»¥ä½¿ç”¨ã€‚
- è¾“å…¥å’Œè¾“å‡ºæ¨¡å¼ï¼šè¾“å…¥å’Œè¾“å‡ºæ¨¡å¼ä¸ºæ¯ä¸ªLCELé“¾æä¾›äº†ä»é“¾çš„ç»“æ„æ¨æ–­å‡ºçš„Pydanticå’ŒJSONSchemaæ¨¡å¼ã€‚è¿™å¯ç”¨äºéªŒè¯è¾“å…¥è¾“å‡ºï¼Œå¹¶ä¸”æ˜¯LangServeçš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚

## Ruable interface

ä¸ºäº†å°½å¯èƒ½ç®€åŒ–åˆ›å»ºè‡ªå®šä¹‰é“¾çš„è¿‡ç¨‹ï¼Œå®ç°äº†ä¸€ä¸ªRunableçš„åè®®ï¼Œè®¸å¤šLangChainçš„ç»„ä»¶éƒ½å®ç°äº†Runableåè®®ï¼ŒåŒ…æ‹¬èŠå¤©æ¨¡å‹ã€LLMsã€è¾“å‡ºè§£æå™¨ã€æ£€ç´¢å™¨ã€æç¤ºæ¨¡ç‰ˆç­‰ç­‰ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›æœ‰ç”¨çš„åŸºæœ¬ç»„ä»¶å¯ç”¨äºå¤„ç†å¯è¿è¡Œå¯¹è±¡ã€‚è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†æ¥å£ï¼Œå¯ä»¥è½»æ¾å®šä¹‰è‡ªå®šä¹‰é“¾ï¼Œå¹¶ä»¥æ ‡å‡†æ–¹å¼è°ƒç”¨ã€‚æ ‡å‡†æ¥å£åŒ…æ‹¬ï¼š

- streamï¼šè¿”å›å“åº”çš„æ•°æ®å—ã€‚
- invokeï¼šè¾“å…¥è°ƒç”¨é“¾(åŒæ­¥è°ƒç”¨ï¼‰ã€‚
- batchï¼šè¾“å…¥åˆ—è¡¨è°ƒç”¨é“¾ï¼ˆæ‰¹é‡è°ƒç”¨ï¼‰ã€‚

è¿˜æœ‰ç›¸åº”çš„å¼‚æ­¥æ–¹æ³•ï¼Œåº”è¯¥ä¸asyncioä¸€èµ·ä½¿ç”¨awaitè¯­æ³•ä»¥å®ç°å¹¶å‘ï¼š

- astreamï¼šå¼‚æ­¥è¿”å›å“åº”çš„æ•°æ®å—ã€‚
- ainvokeï¼šå¼‚æ­¥è¾“å…¥è°ƒç”¨é“¾ã€‚
- abatchï¼šå¼‚æ­¥è¾“å…¥åˆ—è¡¨è°ƒç”¨é“¾ã€‚
- astream_logï¼šå¼‚æ­¥è¿”å›ä¸­é—´æ­¥éª¤ï¼Œä»¥åŠæœ€ç»ˆå“åº”ã€‚
- astream_eventsï¼šbetaæµå¼ä¼ è¾“é“¾ä¸­å‘ç”Ÿçš„äº‹ä»¶ã€‚

è¾“å…¥ç±»å‹å’Œè¾“å‡ºç±»å‹å› ç»„ä»¶è€Œå¼‚ï¼š

| ç»„ä»¶       | è¾“å…¥ç±»å‹                         | è¾“å‡ºç±»å‹     |
| ---------- | -------------------------------- | ------------ |
| æç¤º       | å­—å…¸                             | æç¤ºå€¼       |
| èŠå¤©æ¨¡å‹   | å•ä¸ªå­—ç¬¦ä¸²ã€èŠå¤©ä¿¡æ¯åˆ—è¡¨æˆ–æç¤ºå€¼ | èŠå¤©æ¶ˆæ¯     |
| LLM        | å•ä¸ªå­—ç¬¦ä¸²ã€èŠå¤©ä¿¡æ¯åˆ—è¡¨æˆ–æç¤ºå€¼ | å­—ç¬¦ä¸²       |
| è¾“å‡ºè§£æå™¨ | LLMæˆ–èŠå¤©æ¨¡å‹çš„è¾“å‡º              | å–å†³äºè§£æå™¨ |
| æ£€ç´¢å™¨     | å•ä¸ªå­—ç¬¦ä¸²                       | æ–‡æ¡£åˆ—è¡¨     |
| å·¥å…·       | å•ä¸ªå­—ç¬¦ä¸²æ´»å­—å…¸ï¼Œå–å†³äºå·¥å…·     | å–å†³äºå·¥å…·   |

æ‰€æœ‰å¯è¿è¡Œå¯¹è±¡éƒ½å…¬å¼€è¾“å…¥å’Œè¾“å‡ºæ¨¡å¼ä»¥æ£€æŸ¥è¾“å…¥å’Œè¾“å‡ºï¼š

- input_schema:ä»å¯è¿è¡Œå¯¹è±¡æœºæ„è‡ªåŠ¨ç”Ÿæˆçš„è¾“å…¥Pydanticæ¨¡å‹
- output_schema:ä»å¯è¿è¡Œå¯¹è±¡æœºæ„è‡ªåŠ¨ç”Ÿæˆçš„è¾“å‡ºPydanticæ¨¡å‹

æµå¼è¿è¡Œå¯¹äºä½¿åŸºäºLLMçš„åº”ç”¨ç¨‹åºå¯¹æœ€ç»ˆç”¨æˆ·å…·æœ‰å“åº”æ€§è‡³å…³é‡è¦ã€‚é‡è¦çš„LangChainåŸè¯­ï¼Œå¦‚èŠå¤©æ¨¡å‹ã€è¾“å‡ºè§£æå™¨ã€æç¤ºæ¨¡ç‰ˆã€æ£€ç´¢å™¨å’Œä»£ç†éƒ½å®ç°äº†LangChain Runnableæ¥å£ã€‚è¯¥æ¥å£æä¾›äº†ä¸¤ç§é€šç”¨çš„æµå¼å†…å®¹æ–¹æ³•ï¼š

1. åŒæ­¥streamå’Œå¼‚æ­¥astreamï¼šæµå¼ä¼ è¾“é“¾ä¸­çš„æœ€ç»ˆè¾“å‡ºçš„é»˜è®¤å®ç°ã€‚
2. å¼‚æ­¥astream_eventså’Œå¼‚æ­¥astream_logï¼šè¿™äº›æ–¹æ³•æä¾›äº†ä¸€ç§ä»é“¾ä¸­æµå¼ä¼ è¾“ä¸­é—´æ­¥éª¤å’Œæœ€ç»ˆè¾“å‡ºçš„æ–¹å¼ã€‚

## Stream

æ‰€æœ‰çš„Runnableå¯¹è±¡éƒ½å®ç°äº†ä¸€ä¸ªåä¸ºstreamçš„åŒæ­¥æ–¹æ³•å’Œä¸€ä¸ªåä¸ºastreamçš„å¼‚æ­¥å˜ä½“ã€‚è¿™äº›æ–¹æ³•çš†åœ¨ä»¥å—çš„å½¢å¼æµå¼ä¼ è¾“æœ€ç»ˆè¾“å‡ºï¼Œå°½å¿«è¿”å›æ¯ä¸ªå—ã€‚åªæœ‰åœ¨ç¨‹åºä¸­çš„æ‰€æœ‰æ­¥éª¤éƒ½çŸ¥é“å¦‚ä½•å¤„ç†è¾“å…¥æ—¶ï¼Œæ‰èƒ½è¿›è¡Œæµå¼ä¼ è¾“ï¼›å³ï¼Œé€ä¸ªå¤„ç†è¾“å…¥å—ï¼Œå¹¶äº§ç”Ÿç›¸åº”çš„è¾“å‡ºå—ã€‚è¿™ç§å¤„ç†çš„å¤æ‚æ€§å¯ä»¥æœ‰æ‰€ä¸åŒï¼Œä»ç®€å•çš„ä»»åŠ¡ï¼Œå¦‚å‘å‡ºLLMç”Ÿæˆçš„ä»¤ç‰Œï¼Œåˆ°æ›´å…·æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ï¼Œå¦‚åœ¨æ•´ä¸ªJSONå®Œæˆå‰æµå¼ä¼ è¾“JSONç»“æœçš„éƒ¨åˆ†ã€‚å¼€å§‹æ¢ç´¢æµå¼ä¼ è¾“çš„æœ€ä½³æ–¹æ³•ä»LLMåº”ç”¨ç¨‹åºä¸­æœ€é‡è¦çš„ç»„ä»¶å¼€å§‹-LLMæœ¬èº«ï¼

### LLMå’ŒèŠå¤©æ¨¡å‹

å¤§å‹è¯­è¨€æ¨¡å‹ä¸å…¶èŠå¤©å˜ä½“æ˜¯åŸºäºLLMçš„åº”ç”¨ç¨‹åºçš„ä¸»è¦ç“¶é¢ˆã€‚å¤§å‹è¯­è¨€æ¨¡å‹å¯èƒ½éœ€è¦å‡ ç§’çº¢æ‰èƒ½å¯¹æŸ¥è¯¢ç”Ÿæˆå®Œæ•´çš„å“åº”ã€‚è¿™æ¯”åº”ç”¨ç¨‹åºå¯¹æœ€ç»ˆç”¨æˆ·å…·æœ‰å“åº”æ€§çš„çº¦200-300æ¯«ç§’çš„é˜€å€¼è¦æ…¢çš„å¤šã€‚ä½¿åº”ç”¨ç¨‹åºå…·æœ‰æ›´é«˜çš„å“åº”æ€§çš„å…³é”®ç­–ç•¥æ˜¯æ˜¾ç¤ºä¸­é—´è¿›åº¦ï¼›å³ï¼Œé€ä¸ªä»¤ç‰Œæµå¼ä¼ è¾“æ¨¡å‹çš„è¾“å‡ºã€‚æˆ‘ä»¬å°†å±•ç¤ºä½¿ç”¨èŠå¤©æ¨¡å‹æµå¼ä¼ è¾“çš„ç¤ºä¾‹ã€‚ä»¥ä¸‹é€‰é¡¹ä¸­é€‰æ‹©ä¸€ä¸ªï¼š

ä»åŒæ­¥stream APIå¼€å§‹ï¼š

```python
chunks = []
for chunk in model.stream(â€å¤©ç©ºæ˜¯ä»€ä¹ˆé¢œè‰²çš„):
    chunks.append(chunk)
    print(chunk.content, end="|", flush=True)
```

æˆ–è€…ä½¿ç”¨å¼‚æ­¥astream API

```python
chunks = []
async for chunk in model.stream(â€å¤©ç©ºæ˜¯ä»€ä¹ˆé¢œè‰²çš„):
    chunks.append(chunk)
    print(chunk.content, end="|", flush=True)
```

å¾—åˆ°ä¸€ä¸ªç§°ä¸ºAIMessageChunkçš„å“åº”ä½“ï¼Œè¯¥å—è¡¨ç¤ºAIMessageçš„ä¸€éƒ¨åˆ†ã€‚æ¶ˆæ¯å—æ˜¯å¯å åŠ çš„

å¯ä»¥ç®€å•çš„å°†å®ƒä»¬ç›¸åŠ è·å¾—åˆ°ç›®å‰ä¸ºæ­¢çš„å“åº”çŠ¶æ€

```
AIMessageChunk(content="", id='')
```

### Chainï¼ˆé“¾ï¼‰

å‡ ä¹æ‰€æœ‰çš„LLMåº”ç”¨ç¨‹åºéƒ½æ¶‰åŠä¸æ­¢ä¸€æ­¥çš„æ“ä½œï¼Œè€Œä¸ä»…ä»…æ˜¯è°ƒç”¨è¯­è¨€æ¨¡å‹ã€‚ä½¿ç”¨LangChainè¡¨è¾¾å¼è¯­è¨€ï¼ˆLCELï¼‰æ„å»ºä¸€ä¸ªç®€å•çš„é“¾ï¼Œè¯¥é“¾ç»“åˆäº†ä¸€ä¸ªæç¤ºã€æ¨¡å‹å’Œè§£æå™¨ï¼Œå¹¶éªŒè¯æµå¼ä¼ è¾“æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚å°†ä½¿ç”¨StrOutPutParseræ¥è§£ææ¨¡å‹çš„è¾“å‡ºã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„è§£æå™¨ï¼Œä»AIMessageChunkä¸­æå–contentå­—æ®µï¼Œç»™å‡ºæ¨¡å‹è¿”å›çš„tokenã€‚

LCEL æ˜¯ä¸€ç§å£°æ˜å¼çš„æ–¹å¼ï¼Œé€šè¿‡å°†ä¸åŒçš„ LangChain åŸè¯­é“¾æ¥åœ¨ä¸€èµ·æ¥æŒ‡å®šä¸€ä¸ªâ€œç¨‹åºâ€ã€‚ä½¿ç”¨ LCEL åˆ›å»ºçš„é“¾å¯ä»¥è‡ªåŠ¨å®ç° stream å’Œ astreamï¼Œä»è€Œå®ç°å¯¹æœ€ç»ˆè¾“å‡ºçš„æµå¼ä¼ è¾“ã€‚äº‹å®ä¸Šï¼Œä½¿ç”¨ LCEL åˆ›å»ºçš„é“¾å®ç°äº†æ•´ä¸ªæ ‡å‡† Runnable æ¥å£ã€‚

```python
#astream_chain.py
from langchain_core.output_parsers import StrOutputParser
from langchain_core.prompts import ChatPromptTemplate
prompt = ChatPromptTemplate.from_template("ç»™æˆ‘è®²ä¸€ä¸ªå…³äº{topic}çš„ç¬‘è¯")
parser = StrOutputParser()
chain = prompt | model | parser
async for chunk in chain.astream({"topic": "é¹¦é¹‰"}):
    print(chunk, end="|", flush=True)
```

```
|ä¸€ä¸ª|äºº|å»|å® |ç‰©|åº—|ä¹°|é¹¦|é¹‰|ã€‚|åº—|å‘˜|è¯´|ï¼šâ€œ|è¿™|åª|é¹¦|é¹‰|ä¼š|è¯´|è¯|ã€‚â€|
|ä¹°|å›|å®¶|å|ï¼Œ|é‚£|äºº|å‘|ç°|é¹¦|é¹‰|åª|ä¼š|è¯´|ä¸€|å¥|è¯|ï¼šâ€œ|æˆ‘|æ˜¯|é¹¦|é¹‰|ã€‚â€|
|é‚£|äºº|å°±|å»|æ‰¾|åº—|å‘˜|ï¼Œ|è¯´|ï¼šâ€œ|ä½ |ä¸|æ˜¯|è¯´|è¿™|åª|é¹¦|é¹‰|ä¼š|è¯´|è¯|å—|ï¼Ÿ|å®ƒ|åª|ä¼š|è¯´|â€˜|æˆ‘|æ˜¯|é¹¦|é¹‰|â€™|ã€‚â€|
|åº—|å‘˜|å›|ç­”|ï¼šâ€œ|å®ƒ|ç¡®|å®|ä¼š|è¯´|è¯|ï¼Œ|ä½ |æƒ³|å®ƒ|æ€|ä¹ˆ|å¯èƒ½|çŸ¥|é“|è‡ª|å·±|æ˜¯|é¹¦|é¹‰|å‘¢|ï¼Ÿâ€||
```

è¯·æ³¨æ„ï¼Œå³ä½¿æˆ‘ä»¬åœ¨ä¸Šé¢çš„é“¾æ¡æœ«å°¾ä½¿ç”¨äº†parserï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è·å¾—æµå¼è¾“å‡ºã€‚parserä¼šå¯¹æ¯ä¸ªæµå¼å—è¿›è¡Œæ“ä½œã€‚è®¸å¤šLCELåŸºå…ƒä¹Ÿæ”¯æŒè¿™ç§è½¬æ¢å¼çš„æµå¼ä¼ é€’ï¼Œè¿™åœ¨æ„å»ºåº”ç”¨ç¨‹åºæ—¶éå¸¸æ–¹ä¾¿ã€‚

è‡ªå®šä¹‰å‡½æ•°å¯ä»¥è¢«è®¾è®¡ä¸ºè¿”å›ç”Ÿæˆå™¨ï¼Œè¿™æ ·å°±èƒ½å¤Ÿæ“ä½œæµã€‚

æŸäº›å¯è¿è¡Œå®ä½“ï¼Œå¦‚æç¤ºæ¨¡æ¿å’ŒèŠå¤©æ¨¡å‹ï¼Œæ— æ³•å¤„ç†å•ä¸ªå—ï¼Œè€Œæ˜¯èšåˆæ‰€æœ‰å…ˆå‰çš„æ­¥éª¤ã€‚è¿™äº›å¯è¿è¡Œå®ä½“å¯ä»¥ä¸­æ–­æµå¤„ç†ã€‚

LangChainè¡¨è¾¾è¯­è¨€å…è®¸æ‚¨å°†é“¾çš„æ„å»ºä¸ä½¿ç”¨æ¨¡å¼ï¼ˆä¾‹å¦‚åŒæ­¥/å¼‚æ­¥ã€æ‰¹å¤„ç†/æµå¼ç­‰ï¼‰åˆ†å¼€ã€‚å¦‚æœè¿™ä¸æ‚¨æ„å»ºçš„å†…å®¹æ— å…³ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä¾èµ–äºæ ‡å‡†çš„å‘½ä»¤å¼ç¼–ç¨‹æ–¹æ³•ï¼Œé€šè¿‡åœ¨æ¯ä¸ªç»„ä»¶ä¸Šè°ƒç”¨invokeã€batchæˆ–streamï¼Œå°†ç»“æœåˆ†é…ç»™å˜é‡ï¼Œç„¶åæ ¹æ®éœ€è¦åœ¨ä¸‹æ¸¸ä½¿ç”¨å®ƒä»¬ã€‚

### ä½¿ç”¨è¾“å…¥æµ

å¦‚æœæ‚¨æƒ³è¦åœ¨è¾“å‡ºç”Ÿæˆæ—¶ä»ä¸­æµå¼ä¼ è¾“JSONï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ

å¦‚æœæ‚¨ä¾èµ–json.loadsæ¥è§£æéƒ¨åˆ†JSONï¼Œé‚£ä¹ˆè§£æå°†å¤±è´¥ï¼Œå› ä¸ºéƒ¨åˆ†JSONä¸ä¼šæ˜¯æœ‰æ•ˆçš„JSONã€‚

æ‚¨å¯èƒ½ä¼šæŸæ‰‹æ— ç­–ï¼Œå£°ç§°æ— æ³•æµå¼ä¼ è¾“JSONã€‚

äº‹å®è¯æ˜ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹â€”â€”è§£æå™¨éœ€è¦åœ¨è¾“å…¥æµä¸Šæ“ä½œï¼Œå¹¶å°è¯•å°†éƒ¨åˆ†JSONâ€œè‡ªåŠ¨å®Œæˆâ€ä¸ºæœ‰æ•ˆçŠ¶æ€ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ ·ä¸€ä¸ªè§£æå™¨çš„è¿è¡Œï¼Œä»¥äº†è§£è¿™æ„å‘³ç€ä»€ä¹ˆã€‚

```
model = ChatOpenAI(model="gpt-4")
parser = StrOutputParser()
chain = (
        model | JsonOutputParser()
    # ç”±äºLangchainæ—§ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªé”™è¯¯ï¼ŒJsonOutputParseræœªèƒ½ä»æŸäº›æ¨¡å‹ä¸­æµå¼ä¼ è¾“ç»“æœ
)
async def async_stream():
    async for text in chain.astream(
            "ä»¥JSON æ ¼å¼è¾“å‡ºæ³•å›½ã€è¥¿ç­ç‰™å’Œæ—¥æœ¬çš„å›½å®¶åŠå…¶äººå£åˆ—è¡¨ã€‚"
            'ä½¿ç”¨ä¸€ä¸ªå¸¦æœ‰â€œcountriesâ€å¤–éƒ¨é”®çš„å­—å…¸ï¼Œå…¶ä¸­åŒ…å«å›½å®¶åˆ—è¡¨ã€‚'
            "æ¯ä¸ªå›½å®¶éƒ½åº”è¯¥æœ‰é”®`name`å’Œ`population`"
    ):
        print(text, flush=True)
```

```
{}
{'countries': []}
{'countries': [{}]}
{'countries': [{'name': ''}]}
{'countries': [{'name': 'France'}]}
{'countries': [{'name': 'France', 'population': 670}]}
{'countries': [{'name': 'France', 'population': 670810}]}
{'countries': [{'name': 'France', 'population': 67081000}]}
{'countries': [{'name': 'France', 'population': 67081000}, {}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': ''}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain'}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 467}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 467330}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 46733038}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 46733038}, {}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 46733038}, {'name': ''}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 46733038}, {'name': 'Japan'}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 46733038}, {'name': 'Japan', 'population': 126}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 46733038}, {'name': 'Japan', 'population': 126300}]}
{'countries': [{'name': 'France', 'population': 67081000}, {'name': 'Spain', 'population': 46733038}, {'name': 'Japan', 'population': 126300000}]}
```

## Stream events(äº‹ä»¶æµ)

ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†streamå’Œastreamçš„å·¥ä½œåŸç†ï¼Œè®©æˆ‘ä»¬è¿›å…¥äº‹ä»¶æµçš„ä¸–ç•Œã€‚

äº‹ä»¶æµæ˜¯ä¸€ä¸ªbeta APIã€‚è¿™ä¸ªAPIå¯èƒ½ä¼šæ ¹æ®åé¦ˆç•¥å¾®æ›´æ”¹ã€‚

æœ¬æŒ‡å—æ¼”ç¤ºäº†V2 APIï¼Œå¹¶ä¸”éœ€è¦ langchain-core >= 0.2ã€‚å¯¹äºä¸æ—§ç‰ˆæœ¬ LangChain å…¼å®¹çš„V1 APIï¼Œè¯·å‚é˜…è¿™é‡Œã€‚

```
import langchain_core
langchain_core.__version__
```

ä¸ºäº†ä½¿astream_events APIæ­£å¸¸å·¥ä½œï¼š

- åœ¨ä»£ç ä¸­å°½å¯èƒ½ä½¿ç”¨asyncï¼ˆä¾‹å¦‚ï¼Œå¼‚æ­¥å·¥å…·ç­‰ï¼‰

- å¦‚æœå®šä¹‰è‡ªå®šä¹‰å‡½æ•°/å¯è¿è¡Œé¡¹ï¼Œè¯·ä¼ æ’­å›è°ƒ

- åœ¨æ²¡æœ‰ LCEL çš„æƒ…å†µä¸‹ä½¿ç”¨å¯è¿è¡Œé¡¹æ—¶ï¼Œè¯·ç¡®ä¿åœ¨LLMsä¸Šè°ƒç”¨.astream()è€Œä¸æ˜¯.ainvokeä»¥å¼ºåˆ¶LLMæµå¼ä¼ è¾“ä»¤ç‰Œ

#### äº‹ä»¶å‚è€ƒ

ä¸‹é¢æ˜¯ä¸€ä¸ªå‚è€ƒè¡¨ï¼Œæ˜¾ç¤ºå„ç§å¯è¿è¡Œå¯¹è±¡å¯èƒ½å‘å‡ºçš„ä¸€äº›äº‹ä»¶ã€‚

å½“æµå¼ä¼ è¾“æ­£ç¡®å®ç°æ—¶ï¼Œå¯¹äºå¯è¿è¡Œé¡¹çš„è¾“å…¥ç›´åˆ°è¾“å…¥æµå®Œå…¨æ¶ˆè€—åæ‰ä¼šçŸ¥é“ã€‚è¿™æ„å‘³ç€inputsé€šå¸¸ä»…åŒ…æ‹¬endäº‹ä»¶ï¼Œè€Œä¸åŒ…æ‹¬startäº‹ä»¶ã€‚åŒ…æ‹¬`end`äº‹ä»¶ï¼Œè€Œä¸åŒ…æ‹¬`start`äº‹ä»¶ã€‚

| äº‹ä»¶                | åç§°         | å—                             | è¾“å…¥                                          | è¾“å‡º                                            |
| ------------------- | ------------ | ------------------------------ | --------------------------------------------- | ----------------------------------------------- |
| on_chat_model_start | [æ¨¡å‹åç§°]   |                                | {"messages": [[SystemMessage, HumanMessage]]} |                                                 |
| on_chat_model_end   | [æ¨¡å‹åç§°]   |                                | {"messages": [[SystemMessage, HumanMessage]]} | AIMessageChunk(content="hello world")           |
| on_llm_start        | [æ¨¡å‹åç§°]   |                                | {'input': 'hello'}                            |                                                 |
| on_llm_stream       | [æ¨¡å‹åç§°]   | 'Hello'                        |                                               |                                                 |
| on_llm_end          | [æ¨¡å‹åç§°]   |                                | 'Hello human!'                                |                                                 |
| on_chain_start      | format_docs  |                                |                                               |                                                 |
| on_chain_stream     | format_docs  | "hello world!, goodbye world!" |                                               |                                                 |
| on_chain_end        | format_docs  |                                | [Document(...)]                               | "hello world!, goodbye world!"                  |
| on_tool_start       | some_tool    |                                | {"x": 1, "y": "2"}                            |                                                 |
| on_tool_end         | some_tool    |                                |                                               | {"x": 1, "y": "2"}                              |
| on_retriever_start  | [æ£€ç´¢å™¨åç§°] |                                | {"query": "hello"}                            |                                                 |
| on_retriever_end    | [æ£€ç´¢å™¨åç§°] |                                | {"query": "hello"}                            | [Document(...), ..]                             |
| on_prompt_start     | [æ¨¡æ¿åç§°]   |                                | {"question": "hello"}                         |                                                 |
| on_prompt_end       | [æ¨¡æ¿åç§°]   |                                | {"question": "hello"}                         | ChatPromptValue(messages: [SystemMessage, ...]) |

#### èŠå¤©æ¨¡å‹

è®©æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹èŠå¤©æ¨¡å‹äº§ç”Ÿçš„äº‹ä»¶ã€‚

```python
#astream_event.py
events = []
async for event in model.astream_events("hello", version="v2"):
    events.append(event)
```

```python
/home/eugene/src/langchain/libs/core/langchain_core/_api/beta_decorator.py:87: LangChainBetaWarning: This API is in beta and may change in the future.
  warn_beta(
```

å˜¿ï¼ŒAPIä¸­é‚£ä¸ªæœ‰è¶£çš„version="v2"å‚æ•°æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸğŸ˜¾ è¿™æ˜¯ä¸€ä¸ªbeta APIï¼Œæˆ‘ä»¬å‡ ä¹è‚¯å®šä¼šå¯¹å…¶è¿›è¡Œä¸€äº›æ›´æ”¹ï¼ˆäº‹å®ä¸Šï¼Œæˆ‘ä»¬å·²ç»åšäº†ï¼ï¼‰ è¿™ä¸ªç‰ˆæœ¬å‚æ•°å°†å…è®¸æˆ‘ä»¬æœ€å°åŒ–å¯¹æ‚¨ä»£ç çš„ç ´åæ€§æ›´æ”¹ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬ç°åœ¨è®©æ‚¨æ„Ÿåˆ°çƒ¦æ¼ï¼Œè¿™æ ·ä»¥åå°±ä¸å¿…å†çƒ¦æ¼äº†ã€‚ v2ä»…é€‚ç”¨äº langchain-core>=0.2.0ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€äº›å¼€å§‹äº‹ä»¶å’Œä¸€äº›ç»“æŸäº‹ä»¶ã€‚

```python
events[:3]
```

```python
[{'event': 'on_chat_model_start',
  'data': {'input': 'hello'},
  'name': 'ChatAnthropic',
  'tags': [],
  'run_id': 'a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3',
  'metadata': {}},
 {'event': 'on_chat_model_stream',
  'data': {'chunk': AIMessageChunk(content='Hello', id='run-a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3')},
  'run_id': 'a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3',
  'name': 'ChatAnthropic',
  'tags': [],
  'metadata': {}},
 {'event': 'on_chat_model_stream',
  'data': {'chunk': AIMessageChunk(content='!', id='run-a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3')},
  'run_id': 'a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3',
  'name': 'ChatAnthropic',
  'tags': [],
  'metadata': {}}]
```

```python
events[-2:]
```

```python
[{'event': 'on_chat_model_stream',
  'data': {'chunk': AIMessageChunk(content='?', id='run-a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3')},
  'run_id': 'a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3',
  'name': 'ChatAnthropic',
  'tags': [],
  'metadata': {}},
  {'event': 'on_chat_model_end',
  'data': {'output': AIMessageChunk(content='Hello! How can I assist you today?', id='run-a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3')},
  'run_id': 'a81e4c0f-fc36-4d33-93bc-1ac25b9bb2c3',
  'name': 'ChatAnthropic',
  'tags': [],
  'metadata': {}}]
```

# LangChainæœåŠ¡éƒ¨ç½²ä¸é“¾è·¯ç›‘æ§

## LangServeæœåŠ¡éƒ¨ç½²

### æ¦‚è¿°

LangServeå¸®åŠ©å¼€å‘è€…å°† LangChain å¯è¿è¡Œå’Œé“¾éƒ¨ç½²ä¸º REST APIã€‚

è¯¥åº“é›†æˆäº† FastAPI å¹¶ä½¿ç”¨ pydantic è¿›è¡Œæ•°æ®éªŒè¯ã€‚

Pydantic æ˜¯ä¸€ä¸ªåœ¨ Pythonä¸­ç”¨äºæ•°æ®éªŒè¯å’Œè§£æçš„ç¬¬ä¸‰æ–¹åº“ï¼Œç°åœ¨æ˜¯Pythonä¸­ä½¿ç”¨å¹¿æ³›çš„æ•°æ®éªŒè¯åº“ã€‚

- å®ƒåˆ©ç”¨å£°æ˜å¼çš„æ–¹å¼å®šä¹‰æ•°æ®æ¨¡å‹å’ŒPython ç±»å‹æç¤ºçš„å¼ºå¤§åŠŸèƒ½æ¥æ‰§è¡Œæ•°æ®éªŒè¯å’Œåºåˆ—åŒ–ï¼Œä½¿æ‚¨çš„ä»£ç æ›´å¯é ã€æ›´å¯è¯»ã€æ›´ç®€æ´ä¸”æ›´æ˜“äºè°ƒè¯•ã€‚

- å®ƒè¿˜å¯ä»¥ä»æ¨¡å‹ç”Ÿæˆ JSON æ¶æ„ï¼Œæä¾›äº†è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ç­‰åŠŸèƒ½ï¼Œä»è€Œè½»æ¾ä¸å…¶ä»–å·¥å…·é›†æˆã€‚

æ­¤å¤–ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå¯ç”¨äºè°ƒç”¨éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šçš„å¯è¿è¡Œå¯¹è±¡ã€‚JavaScript å®¢æˆ·ç«¯å¯åœ¨ LangChain.js ä¸­æ‰¾åˆ°ã€‚

### ç‰¹æ€§

- ä» LangChain å¯¹è±¡è‡ªåŠ¨æ¨æ–­è¾“å…¥å’Œè¾“å‡ºæ¨¡å¼ï¼Œå¹¶åœ¨æ¯æ¬¡ API è°ƒç”¨ä¸­æ‰§è¡Œï¼Œæä¾›ä¸°å¯Œçš„é”™è¯¯ä¿¡æ¯ã€‚

- å¸¦æœ‰ JSONSchema å’Œ Swagger çš„ API æ–‡æ¡£é¡µé¢ï¼ˆæ’å…¥ç¤ºä¾‹é“¾æ¥ï¼‰ã€‚

- é«˜æ•ˆçš„ /invokeã€/batch å’Œ /stream ç«¯ç‚¹ï¼Œæ”¯æŒå•ä¸ªæœåŠ¡å™¨ä¸Šçš„å¤šä¸ªå¹¶å‘è¯·æ±‚ã€‚

- /stream_log ç«¯ç‚¹ï¼Œç”¨äºæµå¼ä¼ è¾“é“¾/ä»£ç†çš„æ‰€æœ‰ï¼ˆæˆ–éƒ¨åˆ†ï¼‰ä¸­é—´æ­¥éª¤ã€‚

- æ–°åŠŸèƒ½ è‡ª 0.0.40 ç‰ˆæœ¬èµ·ï¼Œæ”¯æŒ /stream_eventsï¼Œä½¿æµå¼ä¼ è¾“æ›´åŠ ç®€ä¾¿ï¼Œæ— éœ€è§£æ /stream_log çš„è¾“å‡ºã€‚

- ä½¿ç”¨ç»è¿‡ä¸¥æ ¼æµ‹è¯•çš„å¼€æº Python åº“æ„å»ºï¼Œå¦‚ FastAPIã€Pydanticã€uvloop å’Œ asyncioã€‚

- ä½¿ç”¨å®¢æˆ·ç«¯ SDK è°ƒç”¨ LangServe æœåŠ¡å™¨ï¼Œå°±åƒæœ¬åœ°è¿è¡Œå¯è¿è¡Œå¯¹è±¡ä¸€æ ·ï¼ˆæˆ–ç›´æ¥è°ƒç”¨ HTTP APIï¼‰ã€‚

### é™åˆ¶

- ç›®å‰ä¸æ”¯æŒæœåŠ¡å™¨å‘èµ·çš„äº‹ä»¶çš„å®¢æˆ·ç«¯å›è°ƒã€‚

- å½“ä½¿ç”¨ Pydantic V2 æ—¶ï¼Œå°†ä¸ä¼šç”Ÿæˆ OpenAPI æ–‡æ¡£ã€‚FastAPI æ”¯æŒæ··åˆä½¿ç”¨ pydantic v1 å’Œ v2 å‘½åç©ºé—´ã€‚æ›´å¤šç»†èŠ‚è¯·å‚è§ä¸‹é¢çš„ç« èŠ‚ã€‚
